"use strict";var listCompanies=[];$(document).ready(function(){function t(t){setTimeout(function(){$(t).fadeOut()},800)}function e(t){$(".partnersList").empty(),$(".sortBtn").removeClass("sortBtnActive"),$(t).addClass("sortBtnActive")}function n(t,e){$(t).each(function(){$(this).each(function(){$(".partnersList").append('<li class="partnersItem">'+this.name+'<span class="partnersPercent">'+this.value+"%</span></li>")})})}$.getJSON("http://codeit.pro/codeitCandidates/serverFrontendTest/company/getList",function(s){if("OK"==s.status){var a={},i=[];$(".sumCompanies").text(s.list.length),t($(".preloaderTotal")),$(s.list).each(function(t,e){$(".listCompanies ul").append('<a href="#" class="list-group-item list-group-item-action">'+e.name+"</a>"),listCompanies.push(e)}),t($(".preloaderList")),$(".listCompanies ul a").on("click",function(){var t=[],s=$(this);event.preventDefault(),$(".partnersList").empty(),$(".partnersBlock").slideDown("slow"),$(".exit").on("click",function(){return $(".partnersBlock").slideUp("slow"),!1}),$(".listCompanies ul a").hasClass("active")?($(".listCompanies ul a").removeClass("active"),$(this).addClass("active")):$(this).addClass("active"),$(listCompanies).each(function(){this.name===s.text()&&(t=t.concat(this.partners))}),$(".sortNameBtnUp").on("click",function(){e(this),t.sort(function(t,e){return t.name>e.name?-1:t.name<e.name?1:0}),n(t,this)}),$(".sortNameBtnUp").hasClass("sortBtnActive")&&(t.sort(function(t,e){return t.name>e.name?-1:t.name<e.name?1:0}),n(t,$(".sortNameBtnUp"))),$(".sortNameBtnDown").on("click",function(){e(this),t.sort(function(t,e){return t.name>e.name?1:t.name<e.name?-1:0}),n(t,this)}),$(".sortNameBtnDown").hasClass("sortBtnActive")&&(t.sort(function(t,e){return t.name>e.name?1:t.name<e.name?-1:0}),n(t,$(".sortNameBtnDown"))),$(".sortPercBtnUp").on("click",function(){e(this),t.sort(function(t,e){return t.value>e.value?1:t.value<e.value?-1:0}),n(t,this)}),$(".sortPercBtnUp").hasClass("sortBtnActive")&&(t.sort(function(t,e){return t.value>e.value?1:t.value<e.value?-1:0}),n(t,$(".sortPercBtnUp"))),$(".sortPercBtnDown").on("click",function(){e(this),t.sort(function(t,e){return t.value>e.value?-1:t.value<e.value?1:0}),n(t,this)}),$(".sortPercBtnDown").hasClass("sortBtnActive")&&(t.sort(function(t,e){return t.value>e.value?-1:t.value<e.value?1:0}),n(t,$(".sortPercBtnDown")))}),$(s.list).each(function(t,e){i.push(e.location.name)}),a=i.reduce(function(t,e){return t[e]=(t[e]||0)+1,t},{}),$(function(){var t=[];for(var e in a)t.push({label:e,data:a[e]});var n=$("#graph");n.unbind(),$.plot(n,t,{series:{pie:{show:!0}},legend:{show:!1}})}),t($(".preloaderLocation"))}else location.reload(!0)}),$.getJSON("http://codeit.pro/codeitCandidates/serverFrontendTest/news/getList",function(e){"OK"==e.status?($(e.list).each(function(t,e){var n=new Date(1e3*e.date);n=moment(n).format("DD.MM.YYYY"),$(".carousel-indicators").append('<li data-target="#carouselIndicators" data-slide-to="'+t+'"></li>'),$(".carousel-inner").append('<div class="carousel-item"><div class="newsContent"><div class="newsMedia"><div class="newsImage"><div style="background-image: url('+e.img.replace(/"/g,"")+')"></div></div><div class="newsAuthor"><span>Author:</span>'+e.author+'</div><div class="newsPublic"><span>Public:</span>'+n+'</div></div><div class="newsText"><a href='+e.link+'><span class="newsTitle">Title</span></a><p class="newsDescription">'+e.description+"</p></div></div></div>")}),$(".carousel-indicators li:first-child").addClass("active"),$(".carousel-item:first-child").addClass("active"),t($(".preloaderNews"))):location.reload(!0)})}),$(window).on("load",function(){$(".pieLabel").on("click",function(){var t=$(this).text();t=t.replace(/\d.*/,""),$(listCompanies).each(function(){t==this.location.name&&$(".graphList").append('<li class="list-group-item">'+this.name+"</li>")}),$(".graphList li").length<=4&&$(".graphList").css({height:"inherit","border-right":"0"}),$(".graphContainer").hide(),$(".graphBack").show(),$(".graphListContainer").show(),$(".graphBack").on("click",function(){$(this).hide(),$(".graphListContainer").hide(),$(".graphContainer").show(),$(".graphList li").remove(),$(".graphList").css({height:"100%","border-right":"inherit"})})})});